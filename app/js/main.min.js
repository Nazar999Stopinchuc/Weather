(()=>{"use strict";var __webpack_modules__={"./app/js/main.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _modules_globals__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./modules/globals */ \"./app/js/modules/globals.js\");\n/* harmony import */ var _modules_api__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./modules/api */ \"./app/js/modules/api.js\");\n/* harmony import */ var _modules_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./modules/utils */ \"./app/js/modules/utils.js\");\n/* harmony import */ var _modules_render__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./modules/render */ \"./app/js/modules/render.js\");\n\r\n\r\n\r\n\r\n\r\nconst debouncedLiveSearch = (0,_modules_utils__WEBPACK_IMPORTED_MODULE_2__.debounce)(liveSearch, 1010);\r\n\r\nasync function submitHandler(e) {\r\n  e.preventDefault();\r\n\r\n  if (!_modules_globals__WEBPACK_IMPORTED_MODULE_0__.input.value.trim()) {\r\n    console.log('enter city name');\r\n    return;\r\n  };\r\n\r\n  if (_modules_globals__WEBPACK_IMPORTED_MODULE_0__.citysList.children.length >= 1) {\r\n    let lat = _modules_globals__WEBPACK_IMPORTED_MODULE_0__.citysList.firstElementChild.dataset.lat;\r\n    let lon = _modules_globals__WEBPACK_IMPORTED_MODULE_0__.citysList.firstElementChild.dataset.lon;\r\n    let cityName = _modules_globals__WEBPACK_IMPORTED_MODULE_0__.citysList.firstElementChild.dataset.city;\r\n\r\n    (0,_modules_render__WEBPACK_IMPORTED_MODULE_3__.renderWeatherByCoordinates)(lat, lon, cityName);\r\n    _modules_globals__WEBPACK_IMPORTED_MODULE_0__.input.value = '';\r\n    _modules_globals__WEBPACK_IMPORTED_MODULE_0__.citysList.innerHTML = '';\r\n    _modules_globals__WEBPACK_IMPORTED_MODULE_0__.input.placeholder = 'enter city';\r\n  } else return;\r\n};\r\n\r\nasync function liveSearch(value) {\r\n  const citysArr = await (0,_modules_api__WEBPACK_IMPORTED_MODULE_1__.getCitys)(value);\r\n  _modules_globals__WEBPACK_IMPORTED_MODULE_0__.citysList.innerHTML = '';\r\n\r\n  if (citysArr) {\r\n\r\n    for (let k of citysArr) {\r\n      const cityName = k.city || '';\r\n      const country = k.country || '';\r\n      const state = k.region || '';\r\n\r\n      const citysListItem = document.createElement('li');\r\n      citysListItem.className = 'form__search-item';\r\n      citysListItem.dataset.city = cityName;\r\n      citysListItem.dataset.lat = k.latitude;\r\n      citysListItem.dataset.lon = k.longitude;\r\n      citysListItem.innerHTML = `<h3>${cityName}</h3><span>${country}, </span><span>${state}</span>`;\r\n\r\n      _modules_globals__WEBPACK_IMPORTED_MODULE_0__.citysList.append(citysListItem);\r\n    };\r\n  };\r\n\r\n  if (_modules_globals__WEBPACK_IMPORTED_MODULE_0__.input.value.length <= 2) {\r\n    _modules_globals__WEBPACK_IMPORTED_MODULE_0__.citysList.innerHTML = '';\r\n  };\r\n};\r\n\r\n\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n  (0,_modules_render__WEBPACK_IMPORTED_MODULE_3__.renderWeatherByCityName)(_modules_globals__WEBPACK_IMPORTED_MODULE_0__[\"startingСity\"]);\r\n\r\n  _modules_globals__WEBPACK_IMPORTED_MODULE_0__.form.addEventListener('submit', submitHandler);\r\n\r\n  _modules_globals__WEBPACK_IMPORTED_MODULE_0__.input.addEventListener('input', function () {\r\n    const inputVal = this.value.trim();\r\n\r\n    if (inputVal == '') {\r\n      return '';\r\n    };\r\n\r\n    this.value = inputVal.charAt(0).toUpperCase() + inputVal.slice(1);\r\n\r\n    if (inputVal.length >= 2) {\r\n      debouncedLiveSearch(inputVal);\r\n    };\r\n  });\r\n\r\n  _modules_globals__WEBPACK_IMPORTED_MODULE_0__.citysList.addEventListener('click', (e) => {\r\n    const target = e.target;\r\n\r\n    if (target.tagName !== 'LI') return;\r\n\r\n    (0,_modules_render__WEBPACK_IMPORTED_MODULE_3__.renderWeatherByCoordinates)(target.dataset.lat, target.dataset.lon, target.dataset.city)\r\n    _modules_globals__WEBPACK_IMPORTED_MODULE_0__.input.value = '';\r\n    _modules_globals__WEBPACK_IMPORTED_MODULE_0__.citysList.innerHTML = '';\r\n  });\r\n});\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n\n//# sourceURL=webpack://prototip_gulp/./app/js/main.js?")},"./app/js/modules/api.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getCitys: () => (/* binding */ getCitys),\n/* harmony export */   getWeatherByCityName: () => (/* binding */ getWeatherByCityName),\n/* harmony export */   getWeatherByCoordinates: () => (/* binding */ getWeatherByCoordinates),\n/* harmony export */   getWeatherData: () => (/* binding */ getWeatherData)\n/* harmony export */ });\n/* harmony import */ var _globals__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./globals */ \"./app/js/modules/globals.js\");\n\r\n\r\nasync function getWeatherData(query, isCoordinates = false) {\r\n  try {\r\n    const url = isCoordinates\r\n      ? `http://api.openweathermap.org/data/2.5/weather?lat=${query.lat}&lon=${query.lon}&appid=${_globals__WEBPACK_IMPORTED_MODULE_0__.key}&units=metric`\r\n      : `http://api.openweathermap.org/data/2.5/weather?q=${query}&appid=${_globals__WEBPACK_IMPORTED_MODULE_0__.key}&units=metric`;\r\n\r\n\r\n    const response = await fetch(url);\r\n\r\n    if (!response.ok) {\r\n      throw new Error(`HTTP error! status: ${response.status}`);\r\n    }\r\n\r\n\r\n    const data = await response.json();\r\n\r\n    const weatherData = {\r\n      temp: Math.floor(data.main.temp),\r\n      name: data.name,\r\n      humidity: data.main.humidity,\r\n      wind_speed: data.wind.speed,\r\n      icon: data.weather[0].icon,\r\n      descr: data.weather[0].description\r\n    };\r\n\r\n    return weatherData;\r\n  } catch (error) {\r\n    console.log('Ошибка:', error);\r\n    _globals__WEBPACK_IMPORTED_MODULE_0__.input.placeholder = 'city not found';\r\n    return null;\r\n  }\r\n};\r\n\r\nasync function getCitys(citiName) {\r\n  try {\r\n\r\n    const response = await fetch(`https://wft-geo-db.p.rapidapi.com/v1/geo/cities?namePrefix=${citiName}&sort=-population&limit=10`, {\r\n      method: 'GET',\r\n      headers: {\r\n        'X-RapidAPI-Host': 'wft-geo-db.p.rapidapi.com',\r\n        'X-RapidAPI-Key': 'd876d105bcmshf6c43f770370b56p12e2bejsn081822903700'\r\n      }\r\n    });\r\n\r\n\r\n    if (!response.ok) {\r\n      console.log(`Request failed with status: ${response.status}`);\r\n      return undefined;\r\n    };\r\n\r\n    const info = await response.json();\r\n\r\n    return info.data;\r\n\r\n  } catch (error) {\r\n    console.log(`Request failed with status: ${response.status}`);\r\n    return undefined;\r\n  }\r\n};\r\n\r\nasync function getWeatherByCityName(name) {\r\n  return await getWeatherData(name);\r\n};\r\n\r\nasync function getWeatherByCoordinates(lat, lon) {\r\n  return await getWeatherData({ lat, lon }, true);\r\n};\n\n//# sourceURL=webpack://prototip_gulp/./app/js/modules/api.js?")},"./app/js/modules/globals.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   citysList: () => (/* binding */ citysList),\n/* harmony export */   form: () => (/* binding */ form),\n/* harmony export */   input: () => (/* binding */ input),\n/* harmony export */   key: () => (/* binding */ key),\n/* harmony export */   \"startingСity\": () => (/* binding */ startingСity)\n/* harmony export */ });\nconst key = 'ba24ee118b454914f460a8f2f12bd7e3';\r\nconst startingСity = 'Toronto';\r\n\r\nconst form = document.querySelector('.form');\r\nconst input = document.querySelector('.form__input');\r\nconst citysList = document.querySelector('.form__search-live');\n\n//# sourceURL=webpack://prototip_gulp/./app/js/modules/globals.js?")},"./app/js/modules/render.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   renderWeatherByCityName: () => (/* binding */ renderWeatherByCityName),\n/* harmony export */   renderWeatherByCoordinates: () => (/* binding */ renderWeatherByCoordinates),\n/* harmony export */   weatherRender: () => (/* binding */ weatherRender)\n/* harmony export */ });\n/* harmony import */ var _api__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./api */ \"./app/js/modules/api.js\");\n\r\n\r\nasync function weatherRender(query, isCoordinates = false) {\r\n  try {\r\n    const cityInfo = isCoordinates\r\n      ? await (0,_api__WEBPACK_IMPORTED_MODULE_0__.getWeatherByCoordinates)(query.lat, query.lon)\r\n      : await (0,_api__WEBPACK_IMPORTED_MODULE_0__.getWeatherByCityName)(query);\r\n\r\n    const weatherDescription = {\r\n      '01n': 'clear-sky-n',\r\n      '01d': 'clear-sky-d',\r\n\r\n      '02n': 'few-clouds-n',\r\n      '02d': 'few-clouds-d',\r\n\r\n      '03n': 'few-clouds-n',\r\n      '03d': 'few-clouds-d',\r\n\r\n      '04n': 'few-clouds-n',\r\n      '04d': 'few-clouds-d',\r\n\r\n      '09n': 'rain-d',\r\n      '09d': 'rain-d',\r\n\r\n      '10n': 'rain-d',\r\n      '10d': 'rain-d',\r\n\r\n      '11n': 'rain-d',\r\n      '11d': 'rain-d',\r\n\r\n      '13n': 'cloudy-n',\r\n      '13d': 'cloudy-d',\r\n\r\n      '50n': 'cloudy-n',\r\n      '50d': 'cloudy-d',\r\n      \r\n    }\r\n\r\n    const icon = document.querySelector('.weather__img');\r\n    const temp = document.querySelector('.weather__temp');\r\n    const name = document.querySelector('.weather__city');\r\n    const humidity = document.querySelector('#humidity');\r\n    const wind = document.querySelector('#wind');\r\n\r\n    temp.textContent = `${cityInfo.temp} °C`;\r\n    name.textContent = isCoordinates ? query.cityName : cityInfo.name;\r\n    humidity.textContent = `${cityInfo.humidity} %`;\r\n    wind.textContent = `${cityInfo.wind_speed} km/h`;\r\n    icon.src = `images/${weatherDescription[cityInfo.icon]}.png`;\r\n  } catch (error) {\r\n    console.log('Ошибка:', error);\r\n  }\r\n};\r\n\r\nasync function renderWeatherByCityName(city) {\r\n  await weatherRender(city);\r\n};\r\n\r\nasync function renderWeatherByCoordinates(lat, lon, cityName) {\r\n  await weatherRender({ lat, lon, cityName }, true);\r\n};\n\n//# sourceURL=webpack://prototip_gulp/./app/js/modules/render.js?")},"./app/js/modules/utils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   debounce: () => (/* binding */ debounce)\n/* harmony export */ });\nfunction debounce(func, delay) {\r\n  let timeoutId;\r\n  return function (...args) {\r\n    clearTimeout(timeoutId);\r\n    timeoutId = setTimeout(() => func.apply(this, args), delay);\r\n  };\r\n};\n\n//# sourceURL=webpack://prototip_gulp/./app/js/modules/utils.js?")}},__webpack_module_cache__={};function __webpack_require__(e){var r=__webpack_module_cache__[e];return void 0!==r||(r=__webpack_module_cache__[e]={exports:{}},__webpack_modules__[e](r,r.exports,__webpack_require__)),r.exports}__webpack_require__.d=(e,r)=>{for(var n in r)__webpack_require__.o(r,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},__webpack_require__.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__=__webpack_require__("./app/js/main.js")})();